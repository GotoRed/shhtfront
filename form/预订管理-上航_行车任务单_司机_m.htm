<!DOCTYPE html>
<html>
<head>
<meta name="renderer" content="webkit">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<title>上航_行车任务单-手机表单</title>
	<!--字段背景风格App模板-->
	<meta http-equiv='Content-Type' content='text/html; charset=UTF-8' />
	<meta name="viewport" content="initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width">
	
	[#AWSImport]
	[#AWSUIImport]
	
	
	
	<link rel='stylesheet' id='schemeCss' href='../apps/_bpm.platform/css/colorschemes/scheme_aws.css?v=1588908694729'  name='schemeCss'/>
	<link rel="stylesheet" type="text/css" href="../apps/_bpm.portal/css/client.bpm.form.mobile.common.css?v=1588908698315">
	<link rel="stylesheet" type="text/css" href="../apps/com.actionsoft.apps.form.theme.antdui/css/theme/antdui.css?v=1589851448797">
<link type='text/css' rel='stylesheet' id='themeCss' href='../apps/com.actionsoft.apps.form.theme.antdui/css/theme/theme_m.css' name='themeCss'/>
</head>
<style>
  #frmMain{
  	overflow: auto;
    height: 100vh;
  }
</style>
<body>
<form id="frmMain" name="frmMain" method="post">
<div id="aws-form-container" border="0" style="width: 100%; border: 0px;">
<table id="aws-form-maintable" style="table-layout: auto; width: 100%; border: 0px;" cellspacing="0" cellpadding="0" border="0">
<tbody>
<tr id="aws-form-titlebg" class="aws-form-ux-titlebg" style="display: none;">
<td id="aws-form-title" class="aws-form-ux-header">上航_行车任务单</td>
</tr>
<tr class="aws-form-ux-formcontent" id="aws-form-formcontent">
<td>
<table id="table_container" class="awsui-ux table-striped" style="padding: 0px;" width="100%" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="APPLYUNITLabel" for="APPLYUNIT">用车单位</label></td>
<td class="aws-form-ux-content">[#APPLYUNIT]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="APPLYDEPTNAMELabel" for="APPLYDEPTNAME">用车部门</label></td>
<td class="aws-form-ux-content">[#APPLYDEPTNAME]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="CONTACTPERSONLabel" for="CONTACTPERSON">用车联系人</label></td>
<td class="aws-form-ux-content">[#CONTACTPERSON]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="CONTACTPHONELabel" for="CONTACTPHONE">用车联系人手机</label></td>
<td class="aws-form-ux-content">[#CONTACTPHONE]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="APPLYUSERNAMELabel" for="APPLYUSERNAME">预定人</label></td>
<td class="aws-form-ux-content">[#APPLYUSERNAME]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="APPLYUSERCELLPHONELabel" for="APPLYUSERCELLPHONE">预定人手机</label></td>
<td class="aws-form-ux-content">[#APPLYUSERCELLPHONE]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="ISOUTSHANGHAILabel" for="ISOUTSHANGHAI">是否出省</label></td>
<td class="aws-form-ux-content">[#ISOUTSHANGHAI]</td>
</tr>
<tr id="c8f4803a_ff90_0001_809e_9a531d906780">
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="BILLDEPTLabel" class="aws-form-ux-label" for="BILLDEPT">结算部门</label></td>
<td class="aws-form-ux-content">[#BILLDEPT]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="UDATELabel" for="UDATE" flag="labelRequired">使用日期</label></td>
<td class="aws-form-ux-content">[#UDATE]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="ISINTERNALVEHICLELabel" for="ISINTERNALVEHICLE">车辆属性</label></td>
<td class="aws-form-ux-content">[#ISINTERNALVEHICLE]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="VEHICLETYPELabel" for="VEHICLETYPE" flag="labelRequired">车辆类型</label></td>
<td class="aws-form-ux-content">[#VEHICLETYPE]</td>
</tr>
<tr>
<td class="awsui-ux-title"><label id="VEHICLELABELNAMELabel" class="aws-form-ux-label" for="VEHICLELABELNAME" flag="labelRequired">车辆品牌</label></td>
<td class="aws-form-ux-content">[#VEHICLELABELNAME]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="CPHLabel" for="CPH" flag="labelRequired">车牌号</label></td>
<td class="aws-form-ux-content">[#CPH]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="SJXMLabel" for="SJXM" flag="labelRequired">司机姓名</label></td>
<td class="aws-form-ux-content">[#SJXM]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="SJLXFSLabel" for="SJLXFS" flag="labelRequired">司机联系方式</label></td>
<td class="aws-form-ux-content">[#SJLXFS]</td>
</tr>
<tr id="c8fb47d1_57c0_0001_9773_51a0ec001394">
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="BOARDINGPLACELabel" class="aws-form-ux-label" for="BOARDINGPLACE" flag="labelRequired">上车地点</label></td>
<td class="aws-form-ux-content">[#BOARDINGPLACE]</td>
</tr>
<tr id="c8fb47d1_ece0_0001_6996_1f70227215cd">
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="TARGETPLACELabel" class="aws-form-ux-label" for="TARGETPLACE" flag="labelRequired">目的地</label></td>
<td class="aws-form-ux-content">[#TARGETPLACE]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="SKLOCATIONLabel" for="SKLOCATION" flag="labelRequired">上客地点</label></td>
<td class="aws-form-ux-content">[#SKLOCATION]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="XKLOCATIONLabel" for="XKLOCATION" flag="labelRequired">下客地点</label></td>
<td class="aws-form-ux-content">[#XKLOCATION]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="CCSLMSLabel" for="CCSLMS" flag="labelRequired">出车路码</label></td>
<td class="aws-form-ux-content">[#CCSLMS]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="SKLMSLabel" for="SKLMS" flag="labelRequired">上客路码</label></td>
<td class="aws-form-ux-content">[#SKLMS]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="XKLMSLabel" for="XKLMS" flag="labelRequired">下客路码</label></td>
<td class="aws-form-ux-content">[#XKLMS]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="FHSLMSLabel" for="FHSLMS" flag="labelRequired">返场路码</label></td>
<td class="aws-form-ux-content">[#FHSLMS]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="CFSJLabel" for="CFSJ" flag="labelRequired">出车时间</label></td>
<td class="aws-form-ux-content">[#CFSJ]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="SKDATETIMELabel" for="SKDATETIME" flag="labelRequired">上客时间</label></td>
<td class="aws-form-ux-content">[#SKDATETIME]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="XKDATIMELabel" for="XKDATIME" flag="labelRequired">下客时间</label></td>
<td class="aws-form-ux-content">[#XKDATIME]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="FHSJLabel" for="FHSJ" flag="labelRequired">返场时间</label></td>
<td class="aws-form-ux-content">[#FHSJ]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="ISLEAVESTAYLabel" for="ISLEAVESTAY" flag="labelRequired">是否出差过夜</label></td>
<td class="aws-form-ux-content">[#ISLEAVESTAY]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="RETURNPARKLabel" for="RETURNPARK" flag="labelRequired">回场停车地点</label></td>
<td class="aws-form-ux-content">[#RETURNPARK]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="QTMONEYLabel" for="QTMONEY" flag="labelRequired">其他费用</label></td>
<td class="aws-form-ux-content">[#QTMONEY]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="TCFLabel" for="TCF" flag="labelRequired">停车费</label></td>
<td class="aws-form-ux-content">[#TCF]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="GLFLabel" for="GLF" flag="labelRequired">路桥费</label></td>
<td class="aws-form-ux-content">[#GLF]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="STAYMONEYLabel" for="STAYMONEY" flag="labelRequired">住宿费</label></td>
<td class="aws-form-ux-content">[#STAYMONEY]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="LEAVEMONEYLabel" for="LEAVEMONEY">出差费</label></td>
<td class="aws-form-ux-content">[#LEAVEMONEY]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="BILLLISTLabel" for="BILLLIST" flag="labelRequired">结算项目</label></td>
<td class="aws-form-ux-content">[#BILLLIST]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="DAYPRICELabel" for="DAYPRICE" flag="labelRequired">基本租车费</label></td>
<td class="aws-form-ux-content">[#DAYPRICE]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="OTTIMEPRICELabel" for="OTTIMEPRICE">超小时费(元/小时)</label></td>
<td class="aws-form-ux-content">[#OTTIMEPRICE]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="OTLEAVERICELabel" for="OTLEAVERICE">超公里费(元/公里)</label></td>
<td class="aws-form-ux-content">[#OTLEAVERICE]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="QRLCLabel" for="QRLC">总里程(km)</label></td>
<td class="aws-form-ux-content">[#QRLC]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="OVERERDISTANCENUMLabel" for="OVERERDISTANCENUM">超里程数</label></td>
<td class="aws-form-ux-content">[#OVERERDISTANCENUM]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="DAYOVERKILOMETERSPRICELabel" for="DAYOVERKILOMETERSPRICE">超公里费</label></td>
<td class="aws-form-ux-content">[#DAYOVERKILOMETERSPRICE]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="USECARTIMELabel" for="USECARTIME">用车时长</label></td>
<td class="aws-form-ux-content">[#USECARTIME]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="OVERTIMENUMLabel" for="OVERTIMENUM" flag="labelRequired">超时时间</label></td>
<td class="aws-form-ux-content">[#OVERTIMENUM]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="DAYOVERTIMEPRICELabel" for="DAYOVERTIMEPRICE">超时费</label></td>
<td class="aws-form-ux-content">[#DAYOVERTIMEPRICE]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="TOTALMONEYLabel" for="TOTALMONEY">费用总计</label></td>
<td class="aws-form-ux-content">[#TOTALMONEY]</td>
</tr>
<tr>
<td class="awsui-ux-title" style="padding-left: 0px;"><label id="WZUNITPSNLabel" for="WZUNITPSN">外租公司调度</label></td>
<td class="aws-form-ux-content">[#WZUNITPSN]</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="aws-form-bottom">
<td class="aws-form-ux-bottom aws-form-ux-actionsoft">[#Actionsoft]
<div id="hiddenArea" border="0" style="display: none;">[#APPLYUID][#APPLYUNITID][#APPLYDEPTID][#CONTACTPERSONZH][#SJZH][#RESOURCETASKID][#RESOURCETASKFPID][#ORDERID][#MISSIONSTATUS][#BILLDEPTID][#WZUNITPSNID][#WZUNITPSNPHONE][#SETTLEMENTTYPE][#SETTLEMENTTYPE][#ORDERDATE][#CCGYF][#FUWUMANYIDU][#LEAVELOCATION]</div>
</td>
</tr>
</tbody>
</table>
<script src="../apps/com.actionsoft.apps.form.theme.antdui/js/commom.form.js?v=1589851448822"></script>
<script src="../apps/com.actionsoft.apps.form.theme.antdui/js/antdui.js?v=1589851448822"></script>
<script src="../commons/js/aws.mobile.jsapi.js"></script>
</div>
</form>
<script type="text/javascript">
var isRefreshPage =  true;  //点击主表单保存和子表单保存按钮均会刷新主表单
var isAfterSaveRefreshPage =  true;  //只有点击主表单保存按钮的时候才刷新主表单页面
</script>
<script>// <![CDATA[
AWSFormMainAPI.customCloseFormPage(function(){
    //自己处理当前的窗口如何的代码
    var url=localStorage.getItem("backUrl");
    location.href=url;
    return true;//最后返回true
});
// ]]></script>
<script id="onblur">// <![CDATA[
var startcheck = true;
var getoncheck = true;
var dropoffcheck = true;
var returncheck = true;
function startCheck(){
  var startDistance =  $("#CCSLMS").val();
  if(Number(startDistance) < 0){
    mui.alert("请输入正确的里程数！");
    startcheck = false;
  }else{
    startcheck = true;
  }    
}
function getOnCheck(){
  var getOnDistance = $("#SKLMS").val();
  if($("#CCSLMS").val()==""){
    getoncheck = false;
    mui.alert("请先输入出发时路码！");
    return;
  }
  var startDistance =  $("#CCSLMS").val();
  if(Number(getOnDistance)<Number(startDistance)){
    getoncheck = false;
    mui.alert("上客路码不能小于出发时路码！");
    return;
  }
  getoncheck = true;
}
function DropoffCheck(){
  var dropOffDistance = $("#XKLMS").val();
  if($("#SKLMS").val()==""){
    mui.alert("请先输入上客路码！");
    dropoffcheck = false;
    return;
  }
  var getOnDistance =  $("#SKLMS").val();
  if(Number(dropOffDistance)<Number(getOnDistance)){
    mui.alert("下客客路码不能小于上客路码！");
    dropoffcheck = false;
    return;
  }
   dropoffcheck = true;
}
function returnCheck(){
  var returnDistance = $("#FHSLMS").val();
  var startDistance =  $("#CCSLMS").val();
  if($("XKLMS").val()==""){
    returncheck = false;
    mui.alert("请先输入下客路码！");
    return;
  }
  var dropOffDistance =  $("#XKLMS").val();
  if(Number(returnDistance)<Number(dropOffDistance)){
    returncheck = false;
    mui.alert("返场路码不能小于下客路码！");
    return;
  }
  if(Number(returnDistance)>Number(startDistance)+Number(1000)){
     returncheck = false;
     mui.alert("单日里程数不能超过1000公里，请检查各个路码填写！");
  	 return;
     }
  returncheck = true;
}
// ]]></script>
<script id="formOnload">// <![CDATA[
function formOnload(){
}
$(".mui-input-right").removeAttr("readonly");
$(".mui-input-clear").removeAttr("readonly");
$("input").each(function(){
	if($(this).attr("readonly")=="readonly"){
		$(this).css({"background-color":"#eee"});
	};
});
function jbzcf(){
    var cx = ui("VEHICLETYPE");//车辆类型
    var clpp = ui("VEHICLELABELNAME");//车辆品牌
  	
	awsui.ajax.request({
        url: "./jd",
        method: "POST",
        async: false,
        dataType: "json",
        data: {
          sid: $("#sid").val(),
          cmd: "com.awspaas.user.apps.shhtaerospaceindustrial_getJsjfy",
          cx: cx,
          clpp:clpp
        },
        success: function (responseObject) {
          if (responseObject.status == 0) {
			var	jsfs = ui("BILLLIST");//结算项目0:接送虹桥机场|1:接送浦东机场|2:日租
            if(jsfs == "0"){
            	$("#DAYPRICE").val(responseObject.hq);//基本租车费
              	$("#OTTIMEPRICE").val("");//超小时费(元/小时)
              	$("#OTLEAVERICE").val("");//超公里费(元/公里)
            	$("#OVERERDISTANCENUM").val(0);//超里程数
              	$("#DAYOVERKILOMETERSPRICE").val(0);//超公里费
             	$("#OVERTIMENUM").val("");//超时时间
              	$("#DAYOVERTIMEPRICE").val(0);//超时费
            }else if(jsfs == "1"){
            	$("#DAYPRICE").val(responseObject.pd);
              	$("#OTTIMEPRICE").val("");//超小时费(元/小时)
              	$("#OTLEAVERICE").val("");//超公里费(元/公里)
              	$("#OVERERDISTANCENUM").val(0);//超里程数
              	$("#DAYOVERKILOMETERSPRICE").val(0);//超公里费
             	$("#OVERTIMENUM").val("");//超时时间
              	$("#DAYOVERTIMEPRICE").val(0);//超时费
            }else if(jsfs == "2"){
             	$("#DAYPRICE").val(responseObject.jbzcf);
            	$("#OTTIMEPRICE").val(responseObject.csf);//超小时费(元/小时)
              	$("#OTLEAVERICE").val(responseObject.cglf);//超公里费(元/公里)
            }
          }
        }
    });
}
// ]]></script>
<script id="formSave">// <![CDATA[
function formSave(isTransact) {
  	var useDate = $("#UDATE").val();//用车时间
  	var userCarType = ui("VEHICLETYPE");//车辆类型
  	if(useDate != ""){
    	useDate = useDate.substring(0,10);
    }
    if(startcheck == false)
  {
    mui.alert("请检查出车时候路码！");
    return false;
  } if(getoncheck == false)
  {
    mui.alert("请检查上客路码！");
    return false;
  } if(dropoffcheck == false)
  {
    mui.alert("请检查下客路码！");
    return false;
  } if(returncheck == false)
  {
    mui.alert("请检查返回路码！");
    return false;
  }
  	var d = new Date(useDate);
  	var useTwoDate = formatDate(d);
  	var useTwoDateNew = new Date(useTwoDate);//用车的后两天日期
  	var sysDate = new Date();
  	var date = twoStr(2);
  	var sysDateNew = new Date(date);//系统当前日期
  	/*if((userCarType == "4" || userCarType == "5") && sysDateNew > useTwoDateNew){//车辆类型:4:中巴5:大巴
    	mui.alert("大巴车辆需提前两天预定！","info");
        return false;
    }*/
    var userTaskDefId = $("#userTaskDefId").val();
  	console.log(userTaskDefId);
  	if(userTaskDefId == "obj_c8f1f74f91b00001a4a53941155bca40"){//外租公司调度接收
    	var sjh = $("#SJLXFS").val();//司机联系方式
      	var cph = $("#CPH").val();//车牌号
      	if(Number(sjh.length) >11 || Number(sjh.length) <11 || !(/(^[1-9]\d*$)/.test(sjh))){//手机号
        	mui.alert("请输入正确的手机号！");
            return false;
        }
      	if(Number(cph.length)<7 || Number(cph.length)>8){//车牌号7位和8位
        	mui.alert("请输入正确的车牌号！");
            return false;
        }
    }else {//司机行车确认、车队结算员
        var getOnTime = $("#SKDATETIME").val();//上客时间
        var retrunTime = $("#FHSJ").val();//回场时间
        var overTimeFee = $("#OTTIMEPRICE").val();//超小时费(元/小时)
        var overKmFee =  $("#OTLEAVERICE").val();//超公里费(元/公里)
        var totalOver =  $("#OVERTIMENUM").val();//超时时间
        var returnDistance = $("#FHSLMS").val();//返场路码
        var getOnDistance = $("#SKLMS").val();//上客路码
        var dropOffTime = $("#XKDATIME").val();//下客时间
        var dropOffTime1 = $("#XKDATIME").val();
        var dropOffDistance = $("#XKLMS").val();//下客路码
        var startTime= $("#CFSJ").val();//出车时间 
        var basicFee = $("#DAYPRICE").val();//基础费用
        var carType = ui("VEHICLETYPE");//车辆类型
        var carLogo = ui("VEHICLELABELNAME");//车辆品牌
       	if( (new Date(retrunTime).getTime()-new Date(getOnTime).getTime()) > 24*3600*1000){
    		mui.alert("单次任务单不能超过24小时，请确认！");
    		return false;
  		}
        if(new Date(retrunTime).getTime() < new Date(dropOffTime).getTime()){
            mui.alert("返场时间不能小于下客时间，请确认！");
            return false;
        }
        if(new Date(dropOffTime).getTime() < new Date(getOnTime).getTime()){
          mui.alert("下客时间不能小于上客时间，请确认！");
          return false;
        }
        if(new Date(getOnTime).getTime() < new Date(startTime).getTime()){
            mui.alert("上客时间不能小于上客时间，请确认！");
            return false;
        }
        var totalFee = 0;
        var totalOverTimeFee = 0;
        var totalOverKmFee = 0;
        var totalOtherFee = 0;
        var totalBasicFee = 0;
        var roadBridgeFee = $("#GLF").val();
        var hotelCost = $("#STAYMONEY").val();
        var parkingFee = $("#TCF").val();
        var otherFee = $("#QTMONEY").val();
        totalOtherFee = Number(roadBridgeFee)+Number(hotelCost)+Number(parkingFee)+Number(otherFee);
        var rz = ui("BILLLIST");  
        var utcuseCarTime = new Date(retrunTime).getTime()-new Date(getOnTime).getTime();
            var useCarTimeInt = Math.floor(utcuseCarTime/1000/3600);
            var userCarTimeFLoat = utcuseCarTime/1000/3600;
            var useCarDistance = returnDistance-getOnDistance;
            var useCarTime = (useCarTimeInt+0.5*Math.ceil(userCarTimeFLoat-useCarTimeInt)+0.5*Math.ceil(userCarTimeFLoat-useCarTimeInt-0.5)); 
            $("#QRLC").val(Number(useCarDistance)); 
            $("#USECARTIME").val(Number(useCarTime));  
        if(rz == "2"){
            /**
             * 日租车费用计算，先计算额外费用部分；
             * 低于4小时算日租半天费用，4小时至9小时之间算全天日租费用；
             * 超出9小时额外算费用。
             */
            var otherCity = ui("ISLEAVESTAY");
            $("#CCGYF").val("0");
            if(otherCity == "1"){
                $("#CCGYF").val(Number(overTimeFee)*5);
            }
            var otherCityFee = $("#CCGYF").val();
            totalOtherFee = Number(totalOtherFee)+Number(otherCityFee);
          	
            if(userCarTimeFLoat <= 0){
                mui.alert("用车时间错误，请检查时间填写");
                return false;
            }
          	
            $("#OVERERDISTANCENUM").val("0");//超里程数
            $("#DAYOVERKILOMETERSPRICE").val("0");//超公里费
            $("#OVERTIMENUM").val("0");
          	console.log("用车理程"+useCarDistance)
            if(useCarTime <= 4){         
                totalBasicFee = Number(basicFee)/2;  
                if(Number(useCarDistance)>50){
                    $("#OVERERDISTANCENUM").val(Number(useCarDistance)-50);
                    $("#DAYOVERKILOMETERSPRICE").val(Number(useCarDistance-50)*Number(overKmFee));
                }
                totalOverKmFee = $("#DAYOVERKILOMETERSPRICE").val();                
            }else if(useCarTime > 4){
                totalBasicFee = Number(basicFee); 
                if(Number(useCarDistance)>100){
                    $("#OVERERDISTANCENUM").val(Number(useCarDistance)-100);
                    $("#DAYOVERKILOMETERSPRICE").val(Number(useCarDistance-100)*Number(overKmFee));
                }
                totalOverKmFee = $("#DAYOVERKILOMETERSPRICE").val();
                if(useCarTime > 9){
                    $("#OVERTIMENUM").val(useCarTime-9);
                    $("#DAYOVERTIMEPRICE").val(Number(useCarTime-9)*Number(overTimeFee));//超时费                     
                }
                totalOverTimeFee = $("#DAYOVERTIMEPRICE").val();
            }
            totalFee = Number(totalBasicFee)+Number(totalOverKmFee)+Number(totalOverTimeFee)+Number(totalOtherFee);
            $("#TOTALMONEY").val(totalFee);
          	console.log("费用总计"+totalFee);
        }else if(rz == '1'||rz == '0'){
            /**
             * 计算接送浦东机场的费用
             */
            awsui.ajax.request({
                url: "./jd",
                method: "POST",
                async: false,
                dataType: "json",
                data: {
                    sid: $("#sid").val(),
                    cmd: "com.awspaas.user.apps.shhtaerospaceindustrial_getJsjfy",
                    cx: carType,
                  	clpp: carLogo
                },
                success: function (responseObject) {
                    if (responseObject.status == 0) {
                      if(rz =='1'){
                        $("#DAYPRICE").val(responseObject.pd);
                      }else if (rz=='0'){
                        $("#DAYPRICE").val(responseObject.hq);
                      }
                      	
                      	$("#DAYPRICE").attr("readonly","true");
            			//$(".awsui-iconfont-buttonedit-search").hide();
                      	$("#OTTIMEPRICE").val("");
                      	$("#OTLEAVERICE").val("");
                    }
                }
            });
        	totalBasicFee = $("#DAYPRICE").val();//更新基本租车费
          console.log("接送机基本费用"+totalBasicFee);
			totalFee = Number(totalBasicFee)+Number(totalOverKmFee)+Number(totalOverTimeFee)+Number(totalOtherFee);
      console.log("费用总计"+totalFee);
        	$("#TOTALMONEY").val(totalFee);//费用总计
        }
    }  	
}
function formatDate(date) {
  var year = date.getFullYear();
  var month = date.getMonth() + 1;
  var day = date.getDate();
  month = month < 10 ? "0" + month : month;
  day = day < 10 ? "0" + day : day;
  returnStr = year + "-" + month + "-" + day;
  return returnStr;
}
function twoStr(n) {
  var returnStr = "";
  var date = new Date();      //当前时间
  var timeStamp = date.getTime() + n * 24 * 60 * 60 * 1000;
  date = new Date(timeStamp);
  var year = date.getFullYear();
  var month = date.getMonth() + 1;
  var day = date.getDate();
  month = month < 10 ? "0" + month : month;
  day = day < 10 ? "0" + day : day;
  returnStr = year + "-" + month + "-" + day;
  return returnStr;
}
// ]]></script>
</body>
</html>